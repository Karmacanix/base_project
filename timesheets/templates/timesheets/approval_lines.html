{% extends "site-base.html" %}

{% load static %}
{% load account %}
{% load i18n %}
{% load mathfilters %}

{% block head_title %}{% trans "Approval" %}{% endblock %}

{% block content %}
<div class="w3-container w3-margin-top">
  <header class="w3-container">
    <h1>{% trans "Approve timesheets" %}</h1>
  </header>  
  
    
    {% if approval_lines %}
    {% regroup approval_lines by timesheet as timesheet_approval %}
    {% for timesheet in timesheet_approval %}
    <div class="w3-container w3-card-4">
      <h3>Weekly timesheet: <strong title="Year - week number - username">{{ timesheet.grouper }}</strong></h3>
    <table id='timetable' class="w3-table-all w3-hoverable w3-grey">
      <thead>
        <tr class='w3-light-blue'>
          <th>Accept or Reject</th>
          <th>Project</th>
          <th>Task</th>
          <th>Mon</th>
          <th>Tue</th>
          <th>Wed</th>
          <th>Thu</th>
          <th>Fri</th>
          <th>Sat</th>
          <th>Sun</th>
          <th>Totals</th>
        </tr>
      </thead>
      <tbody>
        {% for line in timesheet.list %}
        <tr>
          <td>
            <div class="w3-bar">
              <button class="w3-button w3-ripple w3-text-green"><i class="fa fa-check-square fa-2x"></i></button>
              <a class="w3-button w3-ripple w3-text-red" href="{% url 'timesheets:rework-comment' %}"><i class="fa fa-times-rectangle fa-2x"></i></a>
            </div>
          </td>
          <td>{{ line.project }}</td>
          <td>{{ line.task }}</td>
          <td>{{ line.mon }}</td>
          <td>{{ line.tue }}</td>
          <td>{{ line.wed }}</td>
          <td>{{ line.thu }}</td>
          <td>{{ line.fri }}</td>
          <td>{{ line.sat }}</td>
          <td>{{ line.sun }}</td>
          <td class='w3-light-blue'>{{ line.mon|addition:line.tue|addition:line.wed|addition:line.thu|addition:line.fri|addition:line.sat|addition:line.sun }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <br>
  </div>
  <br>
    {% endfor %}
    {% else %}
    <div class="w3-container w3-card-4">
      <h5>You have no timesheets to approve!</h5>
    </div>
    {% endif %}
  </div>
<br>
  <div class="w3-center">
    <div class="pagination">
      <h4><strong><small><span class="step-links">
          {% if page_obj.has_previous %}
              <a class="w3-badge w3-blue" href="?page=1"><i class="fa fa-angle-double-left"></i></a>
              <a class="w3-badge w3-blue" href="?page={{ page_obj.previous_page_number }}"><i class="fa fa-angle-left"></i></a>
          {% endif %}

          <span class="current">
              Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
          </span>

          {% if page_obj.has_next %}
              <a class="w3-badge w3-blue" href="?page={{ page_obj.next_page_number }}"><i class="fa fa-angle-right"></i></a>
              <a class="w3-badge w3-blue" href="?page={{ page_obj.paginator.num_pages }}"><i class="fa fa-angle-double-right"></i></a>
          {% endif %}
      </span></small></strong></h4>
    </div>
  </div>
<br>
</div>

{% endblock %}