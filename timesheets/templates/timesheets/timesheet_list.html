{% extends "site-base.html" %}

{% load static %}
{% load account %}
{% load i18n %}

{% block head_title %}{% trans "Timesheet List" %}{% endblock %}

{% block content %}
<div class="w3-container w3-third w3-margin-top">
  <header class="w3-container">
    <h1>{% trans "Launch a timesheet" %}</h1>
  </header>
  <div class="w3-container w3-card-4">
    {% now "Y" as current_year %}
    {% now "W" as current_week %}
    <input type="week" name="myWeek" id="myWeek" value="{{ current_year }}-W{{ current_week }}">    
    <a class="w3-button w3-section w3-green w3-ripple" href="#" id="demo" onclick="myFunction()">Go</a>
    
  </div>

  <br>

    <header class="w3-container">
      <h3>{% trans "Your timesheets" %}</h3>
    </header>
  <div class="w3-container w3-card-4">
    <br>
    <table id='timetable' class="w3-table-all w3-hoverable w3-grey">
      <thead>
        <tr class='w3-light-blue'>
          <th>Link</th>
          <th>Starts on</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        {% for timesheet in timesheet_list %}
        <tr>
          <td><a class="w3-text-indigo" href="{{ timesheet.get_absolute_url }}">{{ timesheet.name }}</a></td>
          <td>{{ timesheet.week_start|date:"d-M-Y" }}</td>
          {% if timesheet.status == "Approved" %}<td class='w3-green'>{% endif %}
          {% if timesheet.status == "Submitted" %}<td class='w3-blue'>{% endif %}
          {% if timesheet.status == "New" %}<td class='w3-red'>{% endif %}
            {{ timesheet.status }} <small>(on {{ timesheet.updated|date:"d-M-Y" }})</small></td>
        </tr>
        {% endfor %}
      </tbody>
      <tfooter>
        
      </tfooter>
    </table>
    <br>
   
   
  </div>
</div>

{% block extra_body %}
<script>
    function myFunction() {
      var x = document.getElementById("myWeek").value;
      var y = x + "-" + "{{request.user.username}}"
      var z = "/timesheets/" + y
      document.getElementById("demo").href = z;
    }
</script>
{% endblock %}

{% endblock %}