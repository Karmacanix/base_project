{% extends "site-base.html" %}

{% load static %}
{% load account %}
{% load i18n %}
{% load mathfilters %}

{% block head_title %}{% trans "Approvals" %}{% endblock %}

{% block extra_head %}
  <script
  src="https://code.jquery.com/jquery-3.3.1.js"
  integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
  crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.0/moment.js"></script>
{% endblock %}

{% block content %}
<div class="w3-container w3-margin-top">
  <header class="w3-container">
    <h1>{% trans "Timesheet approval list" %}</h1>
  </header>  
  {% if approval_list %}
    <div class="w3-row">
      <table class="w3-table-all w3-large w3-quarter w3-card-4">
        <thead>
          <tr class="w3-light-grey">
            <th>Timesheet</th>
          </tr>
        </thead>
        <tbody>
        {% for approval in approval_list %}
          <tr>
            <td><a href="{% url 'timesheets:timesheet-lines' approval.timesheet %}">{{ approval.timesheet }}</a></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <br>
    {% if approval_history %}
    <div class="w3-row">
      <h4>Approval history</h4>
      <table class="w3-table-all w3-small w3-quarter w3-card-4">
        <thead>
          <tr class="w3-light-grey">
            <th>Timesheet</th>
            <th>Approved?</th>
            <th>Date/Time</th>
            <th>User</th>
          </tr>
        </thead>
        <tbody>
         {% for moment in approval_history %}
          <tr>
            <td>{{ moment.timesheet }}</td>
            {% if moment.approved %}
              <td class="w3-text-green w3-center"><i class="fa fa-check-circle"></i></td>
            {% else %}
              <td class="w3-text-red"><i class="fa fa-times-circle"></i></td>
            {% endif %}
            <td>{{ moment.history_date }}</td>
            <td>{{ moment.history_user }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% endif %}
  {% else %}
    <h4>You have nothing to approve!</h4>
  {% endif %}
</div>
 
{% endblock %}